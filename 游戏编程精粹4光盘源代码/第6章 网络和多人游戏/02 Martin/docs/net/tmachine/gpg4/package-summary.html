<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.4.2) on Fri Aug 29 23:40:06 GMT 2003 -->
<TITLE>
net.tmachine.gpg4
</TITLE>

<META NAME="keywords" CONTENT="net.tmachine.gpg4 package">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="net.tmachine.gpg4";
}
</SCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Package</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <FONT CLASS="NavBarFont1">Class</FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV PACKAGE&nbsp;
&nbsp;<A HREF="../../../net/tmachine/gpg4/gameserver/package-summary.html"><B>NEXT PACKAGE</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="package-summary.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>

</FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<H2>
Package net.tmachine.gpg4
</H2>
This is the example code for GPG4's chapter on creating a server for thousands of clients.
<P>
<B>See:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="#package_description"><B>Description</B></A>
<P>

<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Interface Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../net/tmachine/gpg4/iModule.html" title="interface in net.tmachine.gpg4">iModule</A></B></TD>
<TD>This defines an FSM (finite state machine) for the status of a running module on a server.</TD>
</TR>
</TABLE>
&nbsp;

<P>

<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Class Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../net/tmachine/gpg4/bModule.html" title="class in net.tmachine.gpg4">bModule</A></B></TD>
<TD>Implements the state-change methods, and forces subclasses to obey the state-change invariants (i.e the rules
 defining how state changes may take place)
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../net/tmachine/gpg4/StartServer.html" title="class in net.tmachine.gpg4">StartServer</A></B></TD>
<TD><b>Starts the server running</b> - this class is autmatically run if you execute the JAR file created by
 buildJar (look in the manifest file for the line which starts this class, and in the official Java API Documentation
 for full details on how to package things with JAR)</TD>
</TR>
</TABLE>
&nbsp;

<P>

<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Exception Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../net/tmachine/gpg4/InvalidStateChangeException.html" title="class in net.tmachine.gpg4">InvalidStateChangeException</A></B></TD>
<TD>Implements the state-change methods, and prevents subclasses from mucking with them.</TD>
</TR>
</TABLE>
&nbsp;

<P>
<A NAME="package_description"><!-- --></A><H2>
Package net.tmachine.gpg4 Description
</H2>

<P>
This is the example code for GPG4's chapter on creating a server for thousands of clients.
	<table>
		<tr>
			<td bgcolor="0000FF">
				<font color="FFFF00">
					Game Programming Gems 4 example for Thousands of Clients Per Server
				</font>
			</td>
		</tr>
		<tr>
			<td>
				It's a simple webserver (very simple!) that demonstrates a working implementation of the
				four-stage server described in the gem, using java's non-blocking io (Java NIO). The key
				classes are described below. It does not include any performance-related request-scheduling.
				<P>
				Updates to this example (including any necessary bugfixes) will be made available on
				the website cited in the chapter as [Martin03] - <a href="http://www.grexengine.com/sections/people/adam/gpg4/">http://www.grexengine.com/sections/people/adam/gpg4/</a>. Further enhancements
				(including implementations of the scheduling algorithms in the gem) will also be posted
				to that site periodically.
				<P>
				<h5>Major stages</h5>
				There are four stages described in the gem, and in the accompanying UML diagram:
				<ol>
					<li>Dispatcher</li>
					<li>Cache</li>
					<li>Process</li>
					<li>Transmitter</li>
				</ol>
				<P>
				In this example code, the Dispatcher is implemented by several classes:
				<ul>
					<li>gameserver.AcceptableSelectorHandler = listens on port 80 and accepts incoming connections</li>
					<li>gameserver.ReadableSelectorHandler = reads data from clients, when a request is complete, passes it to an iRequestProcessor to create the response, and gives the request object a reference to an iResponseWriter which will (eventually) send the response back to the client</li>
					<li>gameserver.HTTPRequest = parses the HTTP protocol, and also represents a cacheable request (instances of this class are used as keys in a caching HashMap)</li>
				</ul>
				<P>
				The Cache is implemented by gameserver.SimpleRequestCacher
				<p>
				The Process is implemented by gameserver.RequestProcessor - typically you would have several
				implementations of the iRequestProcessor interface, and your Cache layer would choose
				which one should answer each HTTPRequest, based on the URL requested.
				<P>
				The Transmitter stages is implemented by gameserver.PlainWritableSelectorHandler OR gameserver.GatheringWritableSelectorHandler. The need for two implementations is due to bugs in Java 1.4.2 (the current version)
				when handling large numbers of ByteBuffer's. This bug does NOT show up in this simple
				demo, and the server would continue to work, but performance drops EXPONENTIALLY.
				For more info on the bug, see the website above (I've logged the bug with Sun, and any
				progress will be reported on the website above). If you wish to create a server that
				uses mulitple ByteBuffer's to cache (or pre-generate) separate parts of your responses
				(typically a good idea), you will want to use the PlainWritableSelectorHandler - more
				info is available in the API docs for the two classes.
				<P>
				gameserver.FourThreadWebserver ties together most of the classes listed above, and makes
				sure they are all started in the correct order. You could easily create an alternative
				class that used the other classes to listen on multiple ports (I have a version which
				also listens for encrypted SSL connections, and forwards them to the appropriate
				iRequestProcessor).
				<h5>Final thoughts</h5>
				This is EXAMPLE CODE ONLY - it is NOT recommmended for production use. It is based on
				code that I have used in production systems, but with many features removed (including some
				defensive coding that catches and fixes - or prevents - certain errors). So it should
				work pretty well...the code it's based on takes large amounts of traffic, and regularly
				gets attacked by script-kiddies, so far with no problems (other than those that have
				been worked around already in this code).
				<P>
				Although the example provides an HTTP server, the protocol objects should be VERY easy
				to replace with objects for parsing and creating messages in any arbitrary protocol of
				your choice.
				<P>
				If you have any problems, find any bugs, or have improvements you'd like to share, feel
				free to contact me by the address listed at the start of the gem, or via the website
				cited above. Any such ammendments will be listed on the website, with appropriate credit
				(unless you specifically request otherwise).
			</td>
		</tr>
	</table>
<P>

<P>
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Package</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <FONT CLASS="NavBarFont1">Class</FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;PREV PACKAGE&nbsp;
&nbsp;<A HREF="../../../net/tmachine/gpg4/gameserver/package-summary.html"><B>NEXT PACKAGE</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="package-summary.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>

</FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
