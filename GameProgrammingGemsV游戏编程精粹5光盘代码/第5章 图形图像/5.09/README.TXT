See main.cpp for documentation about this code.
